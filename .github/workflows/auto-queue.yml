# ~~ Generated by projen. To modify, edit .projenrc.ts and run "npx projen".

name: auto-queue
on:
  workflow_run:
    workflows: [build]
    types:
      - completed

env:
  GH_TOKEN: ${{ github.token }}

jobs:
  enableAutoQueue:
    name: "Set AutoQueue on PR #${{ github.event.number }}"
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      contents: write
    steps:
      - name: get_pr_number_artifact
        uses: actions/download-artifact@v4
        with:
          name: pr-number
          path: ${{ github.workspace }}/pr_number.txt
          run-id: ${{ github.event.workflow_run.id }}
          github-token: ${{ github.token }}

      - name: Read PR Number
        id: read_pr
        run: echo "PR_NUMBER=$(cat ${{ github.workspace }}/pr_number.txt)" >> $GITHUB_ENV

      - name: Automerge PR
        uses: peter-evans/enable-pull-request-automerge@v3
        with:
          token: ${{ env.GH_TOKEN }}
          pull-request-number: ${{ env.PR_NUMBER }}
          merge-method: squash